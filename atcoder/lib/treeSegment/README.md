# セグメントツリー
===

```
base = 2 ** (len(l)-1).bit_length() と定義する。その文字列のビット上以上の2の階乗。の2倍。
親ノード: (n-1) // 2
子ノード: 2n+1, 2n+2
initしたlistのiのノードの配列番号: n^base - 1 + i
```

## 段数の数え方
node番号iが与えられた時、ツリーの中でそれが段目かは、ルートノードを0段目とするなら( (i + 1).bit_length() - 1 )段目

```
リストの段数はd段 とするなら、dは0始まりで
d = (len(l) - 1).bit_length()     # dが0始まり
d = (len(l) - 1).bit_length() + 1 # dが1始まりならこっち

このため、返還前の元のリストlにおいて, node番号iの深さは「一番下のノードを0とすると」d段目
d=(len(l) - 1).bit_length() - ( (i + 1).bit_length() - 1 )
(これは一段上がると+1する変数)
```

https://ei1333.hateblo.jp/entry/2017/12/14/000000
